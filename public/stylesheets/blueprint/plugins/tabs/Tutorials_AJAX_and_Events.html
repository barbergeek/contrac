<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="keywords" content="Tutorials:AJAX and Events,Ajax,Events,Manipulation" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="jQuery JavaScript Library (English)" />
		<title>Tutorials:AJAX and Events - jQuery JavaScript Library</title>
		<link rel="stylesheet" href="http://static.jquery.com/files/rocker/css/reset.css" type="text/css" />
		<link rel="stylesheet" href="http://static.jquery.com/files/rocker/css/screen.css" type="text/css" />
		<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "http://docs.jquery.com/skins/monobook/main.css?9"; /*]]>*/</style>

		<link rel="stylesheet" type="text/css" href="http://jquery.com/files/social/jquery.tabs.css" />
		<!--[if lte IE 7]>
		<link rel="stylesheet" href="http://jquery.com/files/social/jquery.tabs-ie.css" type="text/css" media="projection, screen"/>
		<![endif]-->

		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
		<script src="http://jquery.com/files/social/js/jquery.tabs.js"></script>

		<script>$(function(){
			$("div[id=examples]").each(function(){
				$(this).siblings("div:first").find("div.desc").after(
					$(this).find("div.example:has(#demo):first").remove().clone());

				if ( !$("div.example", this).length )
					$(this).remove();
			});

			$("div.entry")
				.children("p").remove().end()
				.find("ul:first li").each(function(){
					if ( !$(this).parent().siblings( $("a",this).attr("href") ).length )
						$(this).remove();
				}).end()
				.not(".ui")
				.tabs();

			$("div.args > br").remove();

			$("div.example")
				.children("p").remove().end()
				.tabs();

			var keywords = "String,Number,Object,Options,Array,Function,Callback,Selector,Event,Element,Integer,Float,Boolean".split(",");

			$("td.default span, td.type").each(function(){
				var html = this.innerHTML;
				jQuery.each(keywords, function(i,key){
					html = html.replace(new RegExp(key, "ig"), "<a href='/Types#" + key + "'>" + key + "</a>");
				});
				this.innerHTML = html;
			});

			$("div[id=source]").each(function(){
				var source = $("pre", this).html()
					.replace(/<\/?a.*?>/ig, "")
					.replace(/<\/?strong.*?>/ig, "")
					.replace(/&lt;/g, "<").replace(/&gt;/g, ">").replace(/&amp;/g, "&");

				//var items = [];
				//source = source.replace(/\s*<(link|script).*?>\s\*/g, function(m){
					//items.push(m);
					//return "";
				//}).replace("</head>", items.join("") + "</head>")
				//*/

				var iframe = document.createElement("iframe");
				iframe.src = "/index-blank.html";
				iframe.width = "100%";
				iframe.height = $(this).prev().attr("rel") || "125";
				iframe.style.border = "none";
				$(this).prev().append(iframe);


				$(window).load(function(){
					var doc = iframe.contentDocument || iframe.contentWindow.document;
					  source = source
					          .replace(/<script>([^<])/g,"<script>window.onload = (function(){\ntry{$1")
					          .replace(/([^>])<\/sc/g,  '$1\n}catch(e){}});</sc');

					    source = source
					            .replace("</head>", "<style>html,body{border:0; margin:0; padding:0;}</style></head>");

					doc.open();
					doc.write( source );
					doc.close();
				});

			});
		});</script>
		<script type="text/javascript" src="http://static.jquery.com/files/rocker/scripts/custom.js"></script>
		<link rel="shortcut icon" href="http://static.jquery.com/favicon.ico" type="image/x-icon"/>
		<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "/skins/monobook/main.css?9"; /*]]>*/</style>
		<link rel="stylesheet" type="text/css" media="print" href="/skins/common/commonPrint.css" />
		<!--[if lt IE 5.5000]><style type="text/css">@import "/skins/monobook/IE50Fixes.css";</style><![endif]-->
		<!--[if IE 5.5000]><style type="text/css">@import "/skins/monobook/IE55Fixes.css";</style><![endif]-->
		<!--[if IE 6]><style type="text/css">@import "/skins/monobook/IE60Fixes.css";</style><![endif]-->
		<!--[if IE 7]><style type="text/css">@import "/skins/monobook/IE70Fixes.css?1";</style><![endif]-->
		<!--[if lt IE 7]><script type="text/javascript" src="/skins/common/IEFixes.js"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->
		
		<!-- Head Scripts -->
			</head>
	<body id="jq-interior"  class="mediawiki ns-0 ltr">

	<div id="jq-siteContain">
			<div id="jq-header">
				<a id="jq-siteLogo" href="http://jquery.com/" title="jQuery Home"><img src="http://static.jquery.com/files/rocker/images/logo_jquery_215x53.gif" width="215" height="53" alt="jQuery: Write Less, Do More." /></a>

				<div id="jq-primaryNavigation">

					<ul>
<li class="jq-jquery jq-current"><a href="http://jquery.com/" title="jQuery Home">jQuery</a></li>
<li class="jq-plugins"><a href="http://plugins.jquery.com/" title="jQuery Plugins">Plugins</a></li>
<li class="jq-ui"><a href="http://jqueryui.com/" title="jQuery UI">UI</a></li>
<li class="jq-meetup"><a href="http://meetups.jquery.com/" title="jQuery Meetups">Meetups</a></li>
<li class="jq-forum"><a href="http://forum.jquery.com/" title="jQuery Forum">Forum</a></li>
<li class="jq-blog"><a href="http://blog.jquery.com/" title="jQuery Blog">Blog</a></li>
<li class="jq-about"><a href="http://jquery.org/about" title="About jQuery">About</a></li>
<li class="jq-donate"><a href="http://jquery.org/donate" title="Donate to jQuery">Donate</a></li>
					</ul>
				</div><!-- /#primaryNavigation -->

				<div id="jq-secondaryNavigation">
					<ul>
						<li class="jq-download jq-first"><a href="http://docs.jquery.com/Downloading_jQuery">Download</a></li>
						<li class="jq-documentation jq-current"><a href="http://docs.jquery.com/">Documentation</a></li>
						<li class="jq-tutorials"><a href="http://docs.jquery.com/Tutorials">Tutorials</a></li>

						<li class="jq-bugTracker"><a href="http://dev.jquery.com/">Bug Tracker</a></li>
						<li class="jq-discussion jq-last"><a href="http://docs.jquery.com/Discussion">Discussion</a></li>
					</ul>
				</div><!-- /#secondaryNavigation -->

				

				<h1>Documentation</h1>

				<form id="jq-primarySearchForm" action="/Special:Search">

					<div>
						<input type="hidden" value="1" name="ns0"/>
						<label for="primarySearch">Search <span class="jq-jquery">jQuery</span></label>
						<input type="text" value="" accesskey="f" title="Search jQuery" name="search" id="jq-primarySearch"/>
						<button type="submit" name="go" id="jq-searchGoButton"><span>Go</span></button>
					</div>

				</form>

			</div><!-- /#header -->

			<div id="jq-content" class="jq-clearfix">

				<div id="jq-interiorNavigation">
					<div class='jq-portlet' id='jq-p-Getting-Started'>
						<h5>Getting Started</h5>
						<div class='jq-pBody'>

							<ul>

								<li id="jq-n-Main-Page"><a href="/Main_Page">Main Page</a></li>
								<li id="jq-n-Downloading-jQuery"><a href="/Downloading_jQuery">Downloading jQuery</a></li>
				
								<li id="jq-n-How-jQuery-Works"><a href="/How_jQuery_Works">How jQuery Works</a></li>
								<li id="jq-n-FAQ"><a href="/Frequently_Asked_Questions">FAQ</a></li>
								<li id="jq-n-Tutorials"><a href="/Tutorials">Tutorials</a></li>

								<li id="jq-n-Using-jQuery-with-Other-Libraries"><a href="/Using_jQuery_with_Other_Libraries">Using jQuery with Other Libraries</a></li>

								<li id="jq-n-Variable-Types"><a href="/Types">Variable Types</a></li>
							</ul>
				
						</div>
					</div>
						<div class='jq-portlet' id='jq-p-API-Reference'>
						<h5>API Reference</h5>

						<div class='jq-pBody'>

							<ul>
								<li id="jq-n-jQuery-Core"><a href="/Core">jQuery Core</a></li>
								<li id="jq-n-Selectors"><a href="/Selectors">Selectors</a></li>
				
								<li id="jq-n-Attributes"><a href="/Attributes">Attributes</a></li>
								<li id="jq-n-Traversing"><a href="/Traversing">Traversing</a></li>
								<li id="jq-n-Manipulation"><a href="/Manipulation">Manipulation</a></li>

								<li id="jq-n-CSS"><a href="/CSS">CSS</a></li>
								<li id="jq-n-Events"><a href="/Events">Events</a></li>
								<li id="jq-n-Effects"><a href="/Effects">Effects</a></li>
				
								<li id="jq-n-Ajax"><a href="/Ajax">Ajax</a></li>
								<li id="jq-n-Utilities"><a href="/Utilities">Utilities</a></li>
								<li id="jq-n-jQuery-UI"><a href="/UI">jQuery UI</a></li>

							</ul>
						</div>
					</div>
						<div class='jq-portlet' id='jq-p-Plugins'>
				
						<h5>Plugins</h5>
						<div class='jq-pBody'>
							<ul>
								<li id="jq-n-Plugin-Repository"><a href="http://jquery.com/plugins/">Plugin Repository</a></li>

								<li id="jq-n-Authoring"><a href="/Plugins/Authoring">Authoring</a></li>
							</ul>
						</div>
				
					</div>
						<div class='jq-portlet' id='jq-p-Support'>
						<h5>Support</h5>
						<div class='jq-pBody'>

							<ul>

								<li id="jq-n-Mailing-List-and-Chat"><a href="/Discussion">Mailing List and Chat</a></li>
								<li id="jq-n-Submit-New-Bug"><a href="http://jquery.com/dev/bugs/new/">Submit New Bug</a></li>
								<li id="jq-n-Commercial-Support"><a href="/Commercial_Support">Commercial Support</a></li>
				
							</ul>
						</div>
					</div>
						<div class='jq-portlet' id='jq-p-About-jQuery'>

						<h5>About jQuery</h5>

						<div class='jq-pBody'>
							<ul>
								<li id="jq-n-Contributors"><a href="/Contributors">Contributors</a></li>
				
								<li id="jq-n-History-of-jQuery"><a href="/History_of_jQuery">History of jQuery</a></li>
								<li id="jq-n-Sites-Using-jQuery"><a href="/Sites_Using_jQuery">Sites Using jQuery</a></li>

								<li id="jq-n-Browser-Compatibility"><a href="/Browser_Compatibility">Browser Compatibility</a></li>
								<li id="jq-n-License"><a href="/Licensing">Licensing</a></li>

								<li id="jq-n-Donate"><a href="/Donate">Donate</a></li>
							</ul>
				
						</div>
					</div>
						
	<div class="jq-portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="jq-pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="/index.php?title=Special:Whatlinkshere&amp;target=Tutorials%3AAJAX_and_Events">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="/index.php?title=Special:Recentchangeslinked&amp;target=Tutorials%3AAJAX_and_Events">Related changes</a></li>
<li id="t-upload"><a href="/Special:Upload">Upload file</a></li>
<li id="t-specialpages"><a href="/Special:Specialpages">Special pages</a></li>
				<li id="t-print"><a href="/action/render/Tutorials:AJAX_and_Events">Printable version</a></li>				<li id="t-permalink"><a href="/index.php?title=Tutorials:AJAX_and_Events&amp;oldid=20379">Permanent link</a></li>			</ul>
		</div>
	</div>

	<div id="jq-p-cactions" class="jq-portlet">
		<h5>Views</h5>
		<div class="jq-pBody">
		<ul>
				 <li id="jq-ca-nstab-main" class="selected"><a href="/Tutorials:AJAX_and_Events">Article</a></li>
				 <li id="jq-ca-talk" class="new"><a href="/action/edit/Talk:Tutorials:AJAX_and_Events">Discussion</a></li>
				 <li id="jq-ca-edit"><a href="/action/edit/Tutorials:AJAX_and_Events">Edit</a></li>
				 <li id="jq-ca-history"><a href="/action/history/Tutorials:AJAX_and_Events">History</a></li>
		</ul>
		</div>
	</div>
	<div class="jq-portlet" id="jq-p-personal">
		<h5>Personal tools</h5>
		<div class="jq-pBody">
			<ul>
				<li id="jq-pt-login"><a href="/index.php?title=Special:Userlogin&amp;returnto=Tutorials:AJAX_and_Events">Log in / create account</a></li>
			</ul>
		</div>
	</div>

					
				</div><!-- /#interiorNavigation -->





				<div id="jq-primaryContent">
		<div id="column-content">
	<div id="docs-content">
		<a name="top" id="top"></a>
				<!--<div style="background:#efefff; border:#9f9fff 1px solid; padding: 10px;"><strong>UPDATE:</strong> The jQuery API documentation has been completely rewritten and moved to <a href="http://api.jquery.com/">api.jquery.com</a>. More details <a href="http://jquery14.com/pre-release-1/new-jquery-api-site">can be found on the jQuery blog</a>.</div>-->
		<h1 class="firstHeading">Tutorials:AJAX and Events</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From jQuery JavaScript Library</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<div style="padding:10px;margin:10px;background:#F5F5F5;border:1px solid #DDD;">
<p><big>Discusses binding event handlers to DOM elements at the appropriate times.</big>
</p><p><b>Original:</b> <a href="http://www.packtpub.com/jQuery/book/mid/100407j4kh3d" class="external free" title="http://www.packtpub.com/jQuery/book/mid/100407j4kh3d">http://www.packtpub.com/jQuery/book/mid/100407j4kh3d</a><br />
<b>Author:</b> <a href="http://www.learningjquery.com/" class="external text" title="http://www.learningjquery.com/">Karl Swedberg and Jonathan Chaffer</a>
</p>
Similar Tutorials:&nbsp;<a href="/Category:Ajax" title="Category:Ajax">Ajax</a>,&nbsp;<a href="/Category:Events" title="Category:Events">Events</a>,&nbsp;<a href="/Category:Manipulation" title="Category:Manipulation">Manipulation</a></div>
<p>The following tutorial is an excerpt from the book, <a href="http://www.packtpub.com/jQuery/book/mid/100407j4kh3d" class="external text" title="http://www.packtpub.com/jQuery/book/mid/100407j4kh3d">Learning jQuery: Better Interaction Design and Web Development with Simple JavaScript Techniques</a>.  
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/action/edit/Tutorials:AJAX_and_Events?section=1" title="Edit section: Handling the Handlers">edit</a>]</div><a name="Handling_the_Handlers"></a><h2>Handling the Handlers</h2>
<p>Suppose we wanted to highlight all the <code>&lt;h3&gt;</code> elements on the page when  
they are clicked. By now the code to perform such a task is almost  
second-nature:
</p>
<pre>

$(document).ready(function() {
 $('h3').click(function() {
   $(this).toggleClass('highlighted');
 });
});

</pre>
<p>All is well, in that clicking on the letters on the left side of the  
page highlights them. But the dictionary terms are also <code>&lt;h3&gt;</code>  
elements, and they do not get the highlight. Why?
The dictionary terms are not yet part of the DOM when the page is  
loaded, so the event handlers are never bound. This is an example of  
a general issue with event handlers and AJAX calls: <b>loaded elements must have all of their event handlers bound at the appropriate time</b>.
</p><p>A first pass at solving this problem is to factor the binding out  
into a function, and call that function both at the time the document  
is ready and after the AJAX call:
</p>
<pre>

$(document).ready(function() {
 var bindBehaviors = function() {
   $('h3').click(function() {
     $(this).toggleClass('highlighted');
   });
 }

 bindBehaviors();

 $('#letter-a .button').click(function() {
   $('#dictionary').hide().load('a.html', function() {
     bindBehaviors();
     $(this).fadeIn();
   });
 });
});

</pre>
<p>Now we can put all our event handlers in the <code>bindBehaviors()</code>  
function, and call that whenever the DOM changes. Clicking on a  
dictionary term now highlights it, as we intended. Unfortunately,  
we've also managed to cause very strange behavior when the letters  
are clicked. At first they highlight correctly, but after the button  
is clicked (loading the dictionary entries), <b>they no longer highlight  </b>
on subsequent clicks<b>.</b>
</p><p>Closer inspection reveals that, after the AJAX call, the highlighting  
breaks because the click handler is fired twice. A  
doubled <code>.toggleClass()</code> is the same as none at all, so the click seems  
not to work. A tricky behavior to debug, to be sure. The culprit here  
is <code>bindBehaviors()</code>, which binds the click event to all <code>&lt;h3&gt;</code> elements  
each time. After a button click, there are actually two event  
handlers for clicks on an <code>&lt;h3&gt;</code>, which happen to do the exact same thing.
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/action/edit/Tutorials:AJAX_and_Events?section=2" title="Edit section: Scoping an Event Binding Function">edit</a>]</div><a name="Scoping_an_Event_Binding_Function"></a><h3>Scoping an Event Binding Function</h3>
<p>A nice way around this double-firing is to pass some context into  
<code>bindBehaviors()</code> each time we call it. The <code>$()</code> function can take a  
second argument, a DOM node to which the search is restricted. By  
using this feature in <code>bindBehaviors()</code>, we can avoid multiple event  
bindings:
</p>
<pre>

$(document).ready(function() {
 var bindBehaviors = function(scope) {
   $('h3', scope).click(function() {
     $(this).toggleClass('highlighted');
   });
 }

 bindBehaviors(this);

 $('#letter-a .button').click(function() {
   $('#dictionary').hide().load('a.html', function() {
     bindBehaviors(this);
     $(this).fadeIn();
   });
 });
});

</pre>
<p>The first time <code>bindBehaviors()</code> is called, the scope is document, so  
all <code>&lt;h3&gt;</code> elements in the document are matched and have the click  
event bound. After an AJAX load, though, the scope is instead the  
<code>&lt;div id=&quot;dictionary&quot;&gt;</code> element, so the letters are not matched and are  
left alone.
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="/action/edit/Tutorials:AJAX_and_Events?section=3" title="Edit section: Using Event Bubbling">edit</a>]</div><a name="Using_Event_Bubbling"></a><h3>Using Event Bubbling</h3>
<p>Adding scope to a behavior-binding function is often a very elegant  
solution to the problem of binding event handlers after an AJAX load.  
We can often avoid the issue entirely, however, by exploiting event  
bubbling. We can bind the handler not to the elements that are  
loaded, but to a common ancestor element:
</p>
<pre>

$(document).ready(function() {
 $('body').click(function(event) {
   if ($(event.target).is('h3')) {
     $(event.target).toggleClass('highlighted');
   }
 });
});

</pre>
<p>Here we bind the click event handler to the <code>&lt;body&gt;</code> element. Because  
this is not in the portion of the document that is changed when the  
AJAX call is made, the อับดุลย์ ปาตะห์สะมะแว has to be re-bound.  
However, the event context is now wrong, so we compensate for this by  
checking what the event's target attribute is. If the target is of  
the right type, we perform our normal action; otherwise, we do nothing.
</p><p>FYI: This technique is sometimes referred to as "Event Delegation". A live demo of this in action can be found <a href="http://icant.co.uk/sandbox/eventdelegation/" class="external text" title="http://icant.co.uk/sandbox/eventdelegation/">here</a> (yes, it uses Yahoo! UI, but it's still a good example).
</p><!-- 
Pre-expand include size: 3116 bytes
Post-expand include size: 1721 bytes
Template argument size: 1120 bytes
Maximum: 2097152 bytes
-->

<!-- Saved in parser cache with key jqdocs_docs:pcache:idhash:1819-0!1!0!!en!2 and timestamp 20110131220104 -->
<div class="printfooter">
Retrieved from "<a href="http://docs.jquery.com/Tutorials:AJAX_and_Events">http://docs.jquery.com/Tutorials:AJAX_and_Events</a>"</div>
			<div id="catlinks"><p class='catlinks'><a href="/index.php?title=Special:Categories&amp;article=Tutorials%3AAJAX_and_Events" title="Special:Categories">Categories</a>: <span dir='ltr'><a href="/Category:Ajax" title="Category:Ajax">Ajax</a></span> | <span dir='ltr'><a href="/Category:Events" title="Category:Events">Events</a></span> | <span dir='ltr'><a href="/Category:Manipulation" title="Category:Manipulation">Manipulation</a></span> | <span dir='ltr'><a href="/Category:Tutorials" title="Category:Tutorials">Tutorials</a></span></p></div>			<!-- end content -->
			<div class="visualClear"></div>
		</div>
	</div>
		</div>

				</div><!-- /#primaryContent -->

				
				
				
			</div><!-- /#content -->


			<div id="jq-footer" class="jq-clearfix">

				<div id="jq-credits">
				<p id="jq-copyright">&copy; 2010 <a href="http://jquery.org/">The jQuery Project</a></p>
				<p id="jq-hosting">Sponsored by <a href="http://mediatemple.net" class="jq-mediaTemple">Media Temple</a> and <a href="http://jquery.org/sponsors">others</a>.</p>
				</div>

				<div id="jq-footerNavigation">
					<ul>
						<li class="jq-download jq-first"><a href="http://docs.jquery.com/Downloading_jQuery">Download</a></li>
						<li class="jq-documentation jq-current"><a href="http://docs.jquery.com/">Documentation</a></li>
						<li class="jq-tutorials"><a href="http://docs.jquery.com/Tutorials">Tutorials</a></li>
						<li class="jq-bugTracker"><a href="http://dev.jquery.com/">Bug Tracker</a></li>
						<li class="jq-discussion jq-last"><a href="http://docs.jquery.com/Discussion">Discussion</a></li>
					</ul>
				</div><!-- /#secondaryNavigation -->
				
			</div><!-- /#footer -->


	</div><!-- /#siteContain -->

<script type="text/javascript">
var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-1076265-1']); _gaq.push(['_trackPageview']); _gaq.push(['_setDomainName', '.jquery.com']);
(function() {var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);})();
</script>
	</body>
<!-- Cached 20110131220105 -->
</html>

